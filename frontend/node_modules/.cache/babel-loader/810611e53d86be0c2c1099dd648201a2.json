{"ast":null,"code":"var _jsxFileName = \"/Users/Mark/Documents/Skola/OSPP/adrenaline/frontend/src/components/SideDisplayList/Server.js\";\nimport React from 'react';\nimport * as actions from \"../../actions/actions\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nconst axios = require(\"axios\");\n/**\n * Component for displaying the global server\n * @property {function} handleFocusedPage Callback function passed down from LandingPage - Used to get id of what page we click on\n * @property {object} server the global server object\n * @property {Function} resetFocusedThread - callback for resetting the currently focused thread\n * @property {function} setThreadMutex used for locking the rendering of threads \n * @returns the button of the global server\n */\n\n\nconst Server = ({\n  server,\n  handleFocusedPage,\n  resetFocusedThread,\n  setThreadMutex\n}) => {\n  /* useDispatch from dispatch function from store */\n  const dispatch = useDispatch();\n  /*Get the username, magictoken and list of threads from store */\n\n  const username = useSelector(state => state.socketState.username);\n  const magic_token = useSelector(state => state.socketState.magicToken);\n  /*Reset the focused thread, so we show all threads in focusedview */\n\n  const handle = e => {\n    //fetchThreads();\n    resetFocusedThread();\n    handleFocusedPage(e);\n  };\n\n  async function fetchThreads() {\n    setThreadMutex(false);\n\n    try {\n      const response = await axios.post(\"/\", JSON.stringify({\n        action: \"fetch_server_contents\",\n        server_name: server.serverName,\n        magic_token: magic_token,\n        username: username\n      }));\n      const data = await response;\n\n      switch (data.status) {\n        case 200:\n          {\n            /*The threads in the list of threads recieced looks different, need to create new thredobjects from that information */\n            let threads = [];\n\n            for (const thread of data.data.threads) {\n              threads.push({\n                rootPost: {\n                  rootHeader: thread.header,\n                  rootComment: thread.text\n                },\n                username: thread.creator,\n                timestamp: thread.timestamp,\n                comments: thread.comment_list,\n                id: thread.thread_id\n              });\n            }\n\n            ;\n            dispatch(actions.addThreads({\n              threads: threads\n            }));\n          }\n          setThreadMutex(true);\n          break;\n\n        case 404:\n          {\n            console.log(data);\n            setThreadMutex(true);\n            break;\n          }\n\n        default:\n          setThreadMutex(true);\n          alert(\"cannot fetch threads from server\");\n          break;\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  ;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: server.serverName,\n    onClick: handle,\n    className: \"rounded-full h-16 w-16 mb-2 mt-2 input-box-custom-bg hover:bg-gray-500 flex items-center justify-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, server.serverName);\n};\n\nexport default Server;","map":{"version":3,"sources":["/Users/Mark/Documents/Skola/OSPP/adrenaline/frontend/src/components/SideDisplayList/Server.js"],"names":["React","actions","useDispatch","useSelector","axios","require","Server","server","handleFocusedPage","resetFocusedThread","setThreadMutex","dispatch","username","state","socketState","magic_token","magicToken","handle","e","fetchThreads","response","post","JSON","stringify","action","server_name","serverName","data","status","threads","thread","push","rootPost","rootHeader","header","rootComment","text","creator","timestamp","comments","comment_list","id","thread_id","addThreads","console","log","alert","error"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as actions from \"../../actions/actions\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nconst axios = require(\"axios\");\n\n/**\n * Component for displaying the global server\n * @property {function} handleFocusedPage Callback function passed down from LandingPage - Used to get id of what page we click on\n * @property {object} server the global server object\n * @property {Function} resetFocusedThread - callback for resetting the currently focused thread\n * @property {function} setThreadMutex used for locking the rendering of threads \n * @returns the button of the global server\n */\nconst Server = ({ server, handleFocusedPage, resetFocusedThread, setThreadMutex }) => {\n\n    /* useDispatch from dispatch function from store */\n    const dispatch = useDispatch();\n\n    /*Get the username, magictoken and list of threads from store */\n    const username = useSelector((state) => state.socketState.username);\n    const magic_token = useSelector((state) => state.socketState.magicToken);\n\n    /*Reset the focused thread, so we show all threads in focusedview */\n    const handle = (e)=>{\n        //fetchThreads();\n        resetFocusedThread();\n        handleFocusedPage(e);\n    }\n\n    async function fetchThreads() {\n      setThreadMutex(false);\n        try {\n            const response = await axios.post(\n              \"/\",\n              JSON.stringify({\n                action: \"fetch_server_contents\",\n                server_name: server.serverName,\n                magic_token: magic_token ,\n                username: username\n              })\n            );\n            const data = await response;\n            switch (data.status) {\n              case 200: {\n                /*The threads in the list of threads recieced looks different, need to create new thredobjects from that information */\n                let threads = [];\n                for (const thread of data.data.threads){\n                    threads.push({rootPost: {rootHeader: thread.header, rootComment: thread.text}, username: thread.creator, timestamp: thread.timestamp, comments: thread.comment_list, id: thread.thread_id });\n                };\n                dispatch(actions.addThreads({threads: threads}));\n                }\n                setThreadMutex(true);\n                break;\n              case 404: {\n                console.log(data);\n                setThreadMutex(true);\n                break;\n              }\n              default:\n                setThreadMutex(true);\n                alert(\"cannot fetch threads from server\");\n                break;\n            }\n          } catch (error) {\n            console.log(error);\n          }\n    };\n\n    return (\n        <div id={server.serverName} onClick={handle} className=\"rounded-full h-16 w-16 mb-2 mt-2 input-box-custom-bg hover:bg-gray-500 flex items-center justify-center\"> \n            {server.serverName}\n        </div>\n    )\n}\n\nexport default Server;"]},"metadata":{},"sourceType":"module"}