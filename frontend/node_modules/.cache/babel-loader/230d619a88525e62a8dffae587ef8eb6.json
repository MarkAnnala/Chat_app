{"ast":null,"code":"var _jsxFileName = \"/Users/Mark/Documents/Skola/OSPP/adrenaline/frontend/src/components/CommentContainer/CommentContainer.js\";\nimport React, { useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport * as actions from \"../../actions/actions\";\nimport \"../../assets/main.css\";\nimport Comment from \"../Comment/Comment\";\nimport CommentField from \"../CommentField/CommentField.js\";\n/* CommentContainer handles comment state and receives comment updates from the Comment through callback functions.\n This updated comment is then passed to the CommentField in order to update CommentField which in turn displays the comment\n \n CommentField must hold an array representing every parent comment, in this case an array of comment objects.\n The comment object must in turn be an object that holds the actual message, \n the poster of the message and an array of comment objects that symbolize replies. */\n\n/* This function returns a comment object.  */\n\nfunction assembleComment(poster, postedComment) {\n  return {\n    username: poster,\n    comment: postedComment,\n    reply: []\n  };\n}\n\nfunction assembleReply(poster, postedComment, reply) {\n  return {\n    username: poster,\n    comment: postedComment,\n    reply: reply\n  };\n}\n\nconst CommentContainer = ({\n  thread\n}) => {\n  /* Thread is passed in as a paprameter. Use its comments array as start array*/\n\n  /* This state handles the comment input */\n  const [comment, setComment] = useState(\"\");\n  /* This state handles if comment was posted or not */\n\n  const [addComment, setAddComment] = useState(false);\n  /* This state handles reply input */\n\n  const [reply, setReply] = useState(\"\");\n  /* This state handles if reply was posted or not */\n\n  const [addReply, setAddReply] = useState(false);\n  /* Gets the username of the person posting the comment*/\n\n  const poster = useSelector(state => state.socketState.username);\n  /* The recursive comment obj array */\n\n  const [comments, setComments] = useState(thread.comments);\n  /* Index to the comment we reply to */\n\n  const [index, setIndex] = useState(0);\n  /* This state is used as a dummy, we must always pass a dummy function to comment to allow it to use setReplyBox */\n\n  const [dummyReply, setDummyReply] = useState([]);\n  const dispatch = useDispatch();\n  const [commentCounter, setCommentCounter] = useState(0);\n  /* When we successfully change the value of comment, i.e someone comment button is pressed, we \n  dispatch an addComment action.  */\n\n  React.useEffect(() => {\n    if (addComment === true) {\n      dispatch(actions.addComment({\n        thread_id: thread.id,\n        username: poster,\n        comment: comment,\n        reply: {}\n      }));\n      /*  setComments((comments) =>\n        comments.concat(assembleComment(poster, comment))\n      ); */\n\n      setAddComment(false);\n      setCommentCounter(commentCounter + 1);\n      setComment(\"\");\n    }\n  }, [addComment]);\n  React.useEffect(() => {\n    if (addReply === true) {\n      /*  setComments((comments) =>\n        comments.concat(\n          assembleReply(poster, reply, {\n            username: comments[index].username,\n            comment: comments[index].comment,\n          })\n        )\n      ); */\n      dispatch(actions.addComment({\n        thread_id: thread.id,\n        username: poster,\n        comment: reply,\n        reply: {\n          user_id: comments[index].user_id,\n          comment: comments[index].comment\n        }\n      }));\n      setCommentCounter(commentCounter + 1);\n    }\n\n    setAddReply(false);\n    setReply(\"\");\n  }, [addReply]);\n  React.useEffect(() => {\n    if (thread) {\n      setComments(thread.comments);\n      setCommentCounter(thread.comments.length);\n    }\n  }, [thread]);\n\n  const handleInputChange = event => {\n    setComment(event.target.value);\n  };\n\n  const handleReplyChange = event => {\n    setReply(event.target.value);\n  };\n  /* When submitting a reply we must create a new Posted Comment field and concatinate this new pushed comment field with\n  the parrent reply [] array. */\n\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col content-center focused-view-custom-bg h-screen75 overflow-y-scroll\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \" pt-4 w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"commentContainerBg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-white pt-10 pl-4 \",\n    id: \"comments\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }\n  }, \"Comments\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-white pt-10\",\n    id: \"comments_count\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, \"(\", commentCounter, \")\"), /*#__PURE__*/React.createElement(Comment, {\n    setReplyBox: setDummyReply,\n    inputHandler: handleInputChange,\n    comment: comment,\n    setAddComment: setAddComment,\n    username: poster,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  }), comments != [] ? /*#__PURE__*/React.createElement(CommentField, {\n    setIndex: setIndex,\n    inputHandler: handleReplyChange,\n    setAddReply: setAddReply,\n    addReply: addReply,\n    username: poster,\n    comment: comment,\n    comments: comments,\n    setComments: setComments,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 31\n    }\n  }) : null))));\n};\n\nexport default CommentContainer;","map":{"version":3,"sources":["/Users/Mark/Documents/Skola/OSPP/adrenaline/frontend/src/components/CommentContainer/CommentContainer.js"],"names":["React","useState","useSelector","useDispatch","actions","Comment","CommentField","assembleComment","poster","postedComment","username","comment","reply","assembleReply","CommentContainer","thread","setComment","addComment","setAddComment","setReply","addReply","setAddReply","state","socketState","comments","setComments","index","setIndex","dummyReply","setDummyReply","dispatch","commentCounter","setCommentCounter","useEffect","thread_id","id","user_id","length","handleInputChange","event","target","value","handleReplyChange"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport * as actions from \"../../actions/actions\";\nimport \"../../assets/main.css\";\nimport Comment from \"../Comment/Comment\";\nimport CommentField from \"../CommentField/CommentField.js\";\n\n/* CommentContainer handles comment state and receives comment updates from the Comment through callback functions.\n This updated comment is then passed to the CommentField in order to update CommentField which in turn displays the comment\n \n CommentField must hold an array representing every parent comment, in this case an array of comment objects.\n The comment object must in turn be an object that holds the actual message, \n the poster of the message and an array of comment objects that symbolize replies. */\n\n/* This function returns a comment object.  */\nfunction assembleComment(poster, postedComment) {\n  return {\n    username: poster,\n    comment: postedComment,\n    reply: [],\n  };\n}\nfunction assembleReply(poster, postedComment, reply) {\n  return {\n    username: poster,\n    comment: postedComment,\n    reply: reply,\n  };\n}\n\nconst CommentContainer = ({ thread }) => {\n  /* Thread is passed in as a paprameter. Use its comments array as start array*/\n  /* This state handles the comment input */\n  const [comment, setComment] = useState(\"\");\n  /* This state handles if comment was posted or not */\n  const [addComment, setAddComment] = useState(false);\n  /* This state handles reply input */\n  const [reply, setReply] = useState(\"\");\n  /* This state handles if reply was posted or not */\n  const [addReply, setAddReply] = useState(false);\n  /* Gets the username of the person posting the comment*/\n  const poster = useSelector((state) => state.socketState.username);\n  /* The recursive comment obj array */\n  const [comments, setComments] = useState(thread.comments);\n  /* Index to the comment we reply to */\n  const [index, setIndex] = useState(0);\n\n  /* This state is used as a dummy, we must always pass a dummy function to comment to allow it to use setReplyBox */\n  const [dummyReply, setDummyReply] = useState([]);\n  const dispatch = useDispatch();\n\n  const [commentCounter, setCommentCounter] = useState(0);\n\n  /* When we successfully change the value of comment, i.e someone comment button is pressed, we \n  dispatch an addComment action.  */\n  React.useEffect(() => {\n    if (addComment === true) {\n      dispatch(\n        actions.addComment({\n          thread_id: thread.id,\n          username: poster,\n          comment: comment,\n          reply: {},\n        })\n      );\n      /*  setComments((comments) =>\n        comments.concat(assembleComment(poster, comment))\n      ); */\n      setAddComment(false);\n      setCommentCounter(commentCounter + 1);\n      setComment(\"\");\n    }\n  }, [addComment]);\n\n  React.useEffect(() => {\n    if (addReply === true) {\n      /*  setComments((comments) =>\n        comments.concat(\n          assembleReply(poster, reply, {\n            username: comments[index].username,\n            comment: comments[index].comment,\n          })\n        )\n      ); */\n      dispatch(\n        actions.addComment({\n          thread_id: thread.id,\n          username: poster,\n          comment: reply,\n          reply: {\n            user_id: comments[index].user_id,\n            comment: comments[index].comment,\n          },\n        })\n      );\n      setCommentCounter(commentCounter + 1);\n    }\n    setAddReply(false);\n    setReply(\"\");\n  }, [addReply]);\n\n  React.useEffect(() => {\n    if(thread){\n      setComments(thread.comments)\n      setCommentCounter(thread.comments.length)\n    }\n\n  }, [thread]);\n\n\n  const handleInputChange = (event) => {\n    setComment(event.target.value);\n  };\n\n  const handleReplyChange = (event) => {\n    setReply(event.target.value);\n  };\n\n  /* When submitting a reply we must create a new Posted Comment field and concatinate this new pushed comment field with\n  the parrent reply [] array. */\n\n  return (\n    <div className=\"flex flex-col content-center focused-view-custom-bg h-screen75 overflow-y-scroll\">\n      <div className=\" pt-4 w-full\">\n        <div className=\"\">\n          <div className=\"commentContainerBg\">\n            <span className=\"text-white pt-10 pl-4 \" id=\"comments\">\n              Comments\n            </span>\n            <span className=\"text-white pt-10\" id=\"comments_count\">\n              ({commentCounter})\n            </span>\n            <Comment\n              setReplyBox={setDummyReply}\n              inputHandler={handleInputChange}\n              comment={comment}\n              setAddComment={setAddComment}\n              username={poster}\n            ></Comment>\n            {comments != [] ? <CommentField\n              setIndex={setIndex}\n              inputHandler={handleReplyChange}\n              setAddReply={setAddReply}\n              addReply={addReply}\n              username={poster}\n              comment={comment}\n              comments={comments}\n              setComments={setComments}\n            ></CommentField>: null}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CommentContainer;\n"]},"metadata":{},"sourceType":"module"}